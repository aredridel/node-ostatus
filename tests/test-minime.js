var assert=require('assert');
var fs=require('fs');
var path=require('path');
var ostatus=require('ostatus');

/*
 * Test interoperability with a Status.net signed salmon magic enveloppe.
 */

function test(){
	assert.ok(ostatus.salmon.verify_signature(me, key));
}

var me = { 
		sigs: [ 
		        { value: 'OvoBbss29_RYOzE3jHYBA3Aqae7UtekDO7W9QKUd6Smb9hccEgCWlCHoq1X7MW6smjod2aGrfiYrNO7wuj6-3igrBiKpWfNXDThjVatwEJ3FZKpaNlNhV9BOGry8tNU43VwQNq55qWYqgQSdNHA0R-jAtr2o3N-MsNsSSWXUDRg=' } 
		      ],
		data: 'PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGVudHJ5IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDA1L0F0b20iIHhtbG5zOmFjdGl2aXR5PSJodHRwOi8vYWN0aXZpdHlzdHJlYS5tcy9zcGVjLzEuMC8iIHhtbG5zOnBvY289Imh0dHA6Ly9wb3J0YWJsZWNvbnRhY3RzLm5ldC9zcGVjLzEuMCI-CiAgPGlkPmh0dHA6Ly93d3cubG9ic3Rlcm1vbnN0ZXIub3JnL3Byb2ZpbGUva29za2k_cG9zdGlkPTEzMDAyNjk5MDc8L2lkPgogIDx1cGRhdGVkPjIwMTEtMDMtMTZUMTE6MDU6MDcrMDE6MDA8L3VwZGF0ZWQ-CiAgPGxpbmsgcmVsPSJhbHRlcm5hdGUiIHR5cGU9InRleHQvaHRtbCIgaHJlZj0iaHR0cDovL3d3dy5sb2JzdGVybW9uc3Rlci5vcmcvcHJvZmlsZS9rb3NraT9wb3N0aWQ9MTMwMDI2OTkwNyIvPgogIDx0aXRsZT5IaSBFc2Nobm91LCBQSU5HIC4uLjwvdGl0bGU-CiAgPGNvbnRlbnQgdHlwZT0iaHRtbCI-SGkgRXNjaG5vdSwgUElORyAuLi48L2NvbnRlbnQ-CiAgPGF1dGhvcj4KICAgIDx1cmk-YWNjdDprb3NraUBsb2JzdGVybW9uc3Rlci5vcmc8L3VyaT4KICAgIDxuYW1lPlR1b21hcyBLb3NraTwvbmFtZT4KICAgIDxsaW5rIHJlbD0icGhvdG8iIHR5cGU9ImltYWdlL3BuZyIgaHJlZj0iaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyL2EwYzZlNjNiOWI4YjhkNGY2ZmFhM2M5ZWE2MmY0M2JmLnBuZyIvPgogICAgPGxpbmsgcmVsPSJhbHRlcm5hdGUiIHR5cGU9InRleHQvaHRtbCIgaHJlZj0iaHR0cDovL3d3dy5sb2JzdGVybW9uc3Rlci5vcmcvcHJvZmlsZS9rb3NraSIvPgogIDwvYXV0aG9yPgogIDxsaW5rIHJlbD0ib3N0YXR1czphdHRlbnRpb24iIHR5cGU9IiIgaHJlZj0iaHR0cDovL2VzY2hlbmF1ZXIuYmUvdXNlcnMvbGF1cmVudCIvPgogIDxsaW5rIHJlbD0ibWVudGlvbmVkIiB0eXBlPSIiIGhyZWY9Imh0dHA6Ly9lc2NoZW5hdWVyLmJlL3VzZXJzL2xhdXJlbnQiLz4KICA8YWN0aXZpdHk6YWN0b3I-CiAgICA8YWN0aXZpdHk6b2JqZWN0LXR5cGU-aHR0cDovL2FjdGl2aXR5c3RyZWEubXMvc2NoZW1hLzEuMC9wZXJzb248L2FjdGl2aXR5Om9iamVjdC10eXBlPgogICAgPGlkPmh0dHA6Ly93d3cubG9ic3Rlcm1vbnN0ZXIub3JnL3Byb2ZpbGUva29za2k8L2lkPgogICAgPHRpdGxlPlR1b21hcyBLb3NraTwvdGl0bGU-CiAgICA8bGluayByZWw9ImFsdGVybmF0ZSIgdHlwZT0idGV4dC9odG1sIiBocmVmPSJodHRwOi8vd3d3LmxvYnN0ZXJtb25zdGVyLm9yZy9wcm9maWxlL2tvc2tpIi8-CiAgICA8bGluayByZWw9ImF2YXRhciIgdHlwZT0iaW1hZ2UvcG5nIiBocmVmPSJodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIvYTBjNmU2M2I5YjhiOGQ0ZjZmYWEzYzllYTYyZjQzYmYucG5nIi8-CiAgICA8bGluayByZWw9InBob3RvIiB0eXBlPSJpbWFnZS9wbmciIGhyZWY9Imh0dHA6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci9hMGM2ZTYzYjliOGI4ZDRmNmZhYTNjOWVhNjJmNDNiZi5wbmciLz4KICAgIDxwb2NvOm5hbWU-CiAgICAgIDxwb2NvOmdpdmVuTmFtZT5UdW9tYXM8L3BvY286Z2l2ZW5OYW1lPgogICAgICA8cG9jbzpmYW1pbHlOYW1lPktvc2tpPC9wb2NvOmZhbWlseU5hbWU-CiAgICA8L3BvY286bmFtZT4KICA8L2FjdGl2aXR5OmFjdG9yPgogIDxhY3Rpdml0eTp2ZXJiPmh0dHA6Ly9hY3Rpdml0eXN0cmVhLm1zL3NjaGVtYS8xLjAvcG9zdDwvYWN0aXZpdHk6dmVyYj4KICA8YWN0aXZpdHk6b2JqZWN0PgogICAgPGFjdGl2aXR5Om9iamVjdC10eXBlPmh0dHA6Ly9hY3Rpdml0eXN0cmVhLm1zL3NjaGVtYS8xLjAvbm90ZTwvYWN0aXZpdHk6b2JqZWN0LXR5cGU-CiAgICA8aWQ-aHR0cDovL3d3dy5sb2JzdGVybW9uc3Rlci5vcmcvcHJvZmlsZS9rb3NraT9wb3N0aWQ9MTMwMDI2OTkwNzwvaWQ-CiAgICA8Y29udGVudCB0eXBlPSJodG1sIj5IaSBFc2Nobm91LCBQSU5HIC4uLjwvY29udGVudD4KICAgIDxsaW5rIHJlbD0iYWx0ZXJuYXRlIiB0eXBlPSJ0ZXh0L2h0bWwiIGhyZWY9Imh0dHA6Ly93d3cubG9ic3Rlcm1vbnN0ZXIub3JnL3Byb2ZpbGUva29za2k_cG9zdGlkPTEzMDAyNjk5MDciLz4KICA8L2FjdGl2aXR5Om9iamVjdD4KPC9lbnRyeT4K',
	    data_type: 'application/atom xml',
	    encoding: 'base64url',
	    alg: 'RSA-SHA256' 
};

var key = "RSA.quCNBj3KbWmJG1huVxTvHWjCenThHYSb49y7HLPz_fVUfTUYMVfz7Qt8IkTXKj9TartEhNG2FzTIZzu4mkSzkKDZ9NflWs2VIJCWZoF-xJY4FAGKvja-Tuxn-K2trjKa6bypIEfM4qYWVHr_Sxfx3r4fioAe2z90p3AKF6aWm10=.AQAB";


test();
